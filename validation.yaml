validationRules:
  - name: check-severity-label
    scope: Alert
    validations:
      - type: hasLabels
        params:
          labels: [ "severity" ]
      - type: labelHasAllowedValue
        params:
          label: "severity"
          allowedValues: [ "info", "warning", "critical" ]
      - type: expressionCanBeEvaluated
        params:
          timeSeriesLimit: 20
          evaluationDurationLimit: 10s
      - type: expressionUsesExistingLabels
      - type: expressionSelectorsMatchesAnything
      - type: expressionDoesNotUseOlderDataThan
        params:
          limit: "6h"

  - name: check-team-label
    scope: Alert
    validations:
      - type: hasLabels
        params:
          searchInExpr: true
          labels: [ "sigla" ]
      - type: labelHasAllowedValue
        params:
          label: "sigla"
          allowedValues:
            - "sgs"

  - name: check-playbook-annotation
    scope: Alert
    validations:
      - type: hasAnnotations
        params:
          annotations: [ "runbook_url" ]
      - type: annotationIsValidURL
        params:
          annotation: "runbook_url"
          resolveUrl: false

  - name: check-alert-title
    scope: Alert
    validations:
      - type: hasAnnotations
        params:
          annotations: [ "message" ]

  - name: check-prometheus-limitations
    scope: All rules
    validations:
      - type: expressionDoesNotUseOlderDataThan
        params:
          limit: "6h"
      - type: expressionDoesNotUseLabels
        params:
          labels: [ "cluster", "locality", "prometheus-type", "replica" ]
  - name: check-expression
    scope: All rules
    validations:
      - type: expressionUsesMandatoryLabels
        params:
          labelValues: 
            - sigla:sgs
            - projeto:banana
